<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Spin Studio</title>

<style>
body{
  font-family: Arial, sans-serif;
  margin:0;
  padding:0;
  background:#f0f2f5;
  display:flex;
  justify-content:center;
}

.container{
  width:95%;
  max-width:420px;
  margin-top:20px;
  text-align:center;
}

.card{
  background:white;
  padding:18px;
  border-radius:12px;
  box-shadow:0 0 12px rgba(0,0,0,0.1);
  margin-bottom:18px;
}

#wheelCanvas{
  margin-top:10px;
}

button{
  width:100%;
  padding:12px;
  border:none;
  font-size:17px;
  border-radius:10px;
  background:#007bff;
  color:white;
  margin-top:10px;
  cursor:pointer;
}

button:active{ background:#005fcc; }

#result{
  font-size:20px;
  font-weight:600;
  margin-top:12px;
}

/* Customize box */
#editorSection{
  display:none;
  margin-top:10px;
  background:#ffffff;
  padding:12px;
  border-radius:10px;
  box-shadow:0 0 8px rgba(0,0,0,0.1);
}

textarea{
  width:100%;
  height:120px;
  padding:10px;
  border-radius:8px;
  font-size:14px;
  border:1px solid #ccc;
}

/* Monetag Ad Placeholder */
#monetagAd{
  width:100%;
  margin:15px 0;
  text-align:center;
}
</style>

<!-- Monetag SDK -->
<script src='//libtl.com/sdk.js' data-zone='10258271' data-sdk='show_10258271'></script>

</head>

<body>
<div class="container">

  <div class="card">
    <h2>ðŸŽ¡ Spin Studio</h2>
    <canvas id="wheelCanvas" width="300" height="300"></canvas>

    <button onclick="spinWheel()">SPIN</button>

    <!-- Monetag Banner Ad -->
    <div id="monetagAd">
      <p style="color:#aaa; font-size:14px;">Loading ads...</p>
    </div>

    <!-- Customize Wheel Button -->
    <button id="toggleEditor" onclick="toggleEditorSection()">Customize Wheel â–¼</button>
    <div id="editorSection">
      <textarea id="customSegments">Reward 1
Reward 2
Reward 3
Reward 4
Reward 5
Reward 6</textarea>
      <button onclick="applyCustomSegments()">Apply Changes</button>
    </div>

    <div id="result">Result will appear hereâ€¦</div>

    <!-- Reward Ad Button -->
    <button onclick="watchRewardedAd()">Watch Ad & Get Extra Spin</button>

  </div>
</div>

<audio id="winSound" src="https://assets.mixkit.co/sfx/download/mixkit-small-win-2020.wav"></audio>

<script>
// ================== Spin Wheel ==================
let segments = ["Reward 1","Reward 2","Reward 3","Reward 4","Reward 5","Reward 6"];
let startAngle = 0;
let spinTimeout = null;
let arc = Math.PI / (segments.length / 2);
let ctx = document.getElementById("wheelCanvas").getContext("2d");
let userSpins = 0;

function drawWheel(){
  const colors=["#FF6F61","#6B5B95","#88B04B","#F7CAC9","#92A8D1","#955251"];
  const canvas=document.getElementById("wheelCanvas");

  ctx.clearRect(0,0,canvas.width,canvas.height);

  for(let i=0;i<segments.length;i++){
    let angle=startAngle + i*arc;
    ctx.fillStyle=colors[i % colors.length];

    ctx.beginPath();
    ctx.moveTo(150,150);
    ctx.arc(150,150,150,angle,angle+arc);
    ctx.lineTo(150,150);
    ctx.fill();

    ctx.save();
    ctx.translate(150,150);
    ctx.rotate(angle + arc/2);
    ctx.fillStyle="white";
    ctx.font="16px Arial";
    ctx.fillText(segments[i],50,5);
    ctx.restore();
  }

  ctx.fillStyle="black";
  ctx.beginPath();
  ctx.moveTo(150,0);
  ctx.lineTo(140,25);
  ctx.lineTo(160,25);
  ctx.closePath();
  ctx.fill();
}

let spinAngleStart = 0;
let spinTime = 0;
let spinTotal = 0;

function spinWheel(){
  spinAngleStart = Math.random()*10 + 15;
  spinTime = 0;
  spinTotal = Math.random()*3000 + 4000;
  rotateWheel();
}

function rotateWheel(){
  spinTime += 20;
  if(spinTime >= spinTotal){
    stopRotateWheel();
    return;
  }

  let spinAngle = spinAngleStart - easeOut(spinTime,0,spinAngleStart,spinTotal);
  startAngle += (spinAngle * Math.PI/180);
  drawWheel();
  spinTimeout = setTimeout(rotateWheel,20);
}

function stopRotateWheel(){
  clearTimeout(spinTimeout);
  let degrees = startAngle * 180 / Math.PI + 90;
  let index = Math.floor((360 - (degrees % 360)) / (360 / segments.length));

  document.getElementById("result").innerText = "ðŸŽ‰ You Won: " + segments[index];
  document.getElementById("winSound").play();
}

function easeOut(t,b,c,d){
  t/=d;
  return -c * t*(t-2) + b;
}

/* Apply custom */
function applyCustomSegments(){
  let txt = document.getElementById("customSegments").value.trim();
  segments = txt.split("\n").filter(x => x.trim() !== "");
  arc = Math.PI / (segments.length/2);
  drawWheel();
}

/* Toggle */
function toggleEditorSection(){
  const box=document.getElementById("editorSection");
  const btn=document.getElementById("toggleEditor");

  if(box.style.display==="none"){
    box.style.display="block";
    btn.innerText="Customize Wheel â–¼";
  } else {
    box.style.display="none";
    btn.innerText="Customize Wheel â–²";
  }
}

drawWheel();

// ================== Rewarded Popup ==================
function watchRewardedAd(){
  show_10258271('pop').then(() => {
      userSpins++;
      alert('ðŸŽ‰ You earned 1 extra spin!');
  }).catch(e => {
      console.log('Ad not watched or error occurred', e);
  });
}

// ================== In-App Interstitial ==================
function initInAppAds() {
  show_10258271({
    type: 'inApp',
    inAppSettings: {
      frequency: 2,    // 2 ads max
      capping: 0.1,    // within 6 minutes
      interval: 30,    // 30 sec gap
      timeout: 5,      // 5 sec delay
      everyPage: false // session not reset on page change
    }
  });
}

initInAppAds();

</script>
</body>
</html>
