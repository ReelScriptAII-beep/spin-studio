<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Spin Studio</title>

<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f5f5f5;
    margin: 0;
    padding: 20px;
  }

  #wheelCanvas {
    margin-top: 20px;
  }

  button {
    padding: 10px 18px;
    font-size: 16px;
    border: none;
    background: #007bff;
    color: white;
    border-radius: 8px;
    cursor: pointer;
    margin: 10px;
  }

  button:active {
    background: #005fcc;
  }

  #resultBox {
    margin-top: 20px;
    background: #fff;
    padding: 12px;
    border-radius: 10px;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
    font-size: 18px;
  }

  #editorSection {
    background: white;
    padding: 10px;
    border-radius: 10px;
    box-shadow: 0 0 6px rgba(0,0,0,0.1);
    margin-top: 10px;
  }
</style>
</head>

<body>

<h2>ðŸŽ¡ Spin Studio</h2>

<!-- ------------ CUSTOMIZE BUTTON ------------ -->
<button id="toggleEditor" onclick="toggleEditorSection()">Customize Wheel â–¼</button>

<!-- ------------ CUSTOM EDITOR SECTION ------------ -->
<div id="editorSection">
  <h3>Customize Wheel</h3>
  <textarea id="customSegments" rows="6" style="width:100%">Reward 1
Reward 2
Reward 3
Reward 4
Reward 5
Reward 6</textarea>

  <button onclick="applyCustomSegments()">Apply</button>
</div>

<canvas id="wheelCanvas" width="300" height="300"></canvas>

<button onclick="spinWheel()">SPIN</button>

<div id="resultBox">Result will appear hereâ€¦</div>

<!-- WINNING SOUND -->
<audio id="winSound" src="https://assets.mixkit.co/sfx/download/mixkit-small-win-2020.wav"></audio>

<script>
/* ---------------- DEFUALT SEGMENTS ---------------- */
let segments = ["Reward 1","Reward 2","Reward 3","Reward 4","Reward 5","Reward 6"];
let startAngle = 0;
let spinTimeout = null;
const arc = Math.PI / (segments.length / 2);
const ctx = document.getElementById("wheelCanvas").getContext("2d");

/* ---------------- DRAW WHEEL ---------------- */
function drawWheel() {
  const colors = ["#FF6F61","#6B5B95","#88B04B","#F7CAC9","#92A8D1","#955251"];
  const canvas = document.getElementById("wheelCanvas");

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  for (let i = 0; i < segments.length; i++) {
    const angle = startAngle + i * arc;
    ctx.fillStyle = colors[i % colors.length];

    ctx.beginPath();
    ctx.moveTo(150, 150);
    ctx.arc(150, 150, 150, angle, angle + arc);
    ctx.lineTo(150, 150);
    ctx.fill();

    ctx.save();
    ctx.translate(150, 150);
    ctx.rotate(angle + arc / 2);
    ctx.fillStyle = "white";
    ctx.font = "15px Arial";
    ctx.fillText(segments[i], 50, 5);
    ctx.restore();
  }

  // pointer triangle
  ctx.fillStyle = "black";
  ctx.beginPath();
  ctx.moveTo(150, 0);
  ctx.lineTo(140, 20);
  ctx.lineTo(160, 20);
  ctx.closePath();
  ctx.fill();
}

/* ---------------- SPIN FUNCTION ---------------- */
let spinAngleStart = 0;
let spinTime = 0;
let spinTimeTotal = 0;

function spinWheel() {
  spinAngleStart = Math.random() * 10 + 10;
  spinTime = 0;
  spinTimeTotal = Math.random() * 3000 + 4000;
  rotateWheel();
}

function rotateWheel() {
  spinTime += 20;

  if (spinTime >= spinTimeTotal) {
    stopRotateWheel();
    return;
  }

  const spinAngle = spinAngleStart - easeOut(spinTime, 0, spinAngleStart, spinTimeTotal);
  startAngle += (spinAngle * Math.PI / 180);
  drawWheel();
  spinTimeout = setTimeout(rotateWheel, 20);
}

function stopRotateWheel() {
  clearTimeout(spinTimeout);

  const degrees = startAngle * 180 / Math.PI + 90;
  const index = Math.floor((360 - (degrees % 360)) / (360 / segments.length));

  document.getElementById("resultBox").innerText =
    "ðŸŽ‰ You Won: " + segments[index];

  document.getElementById("winSound").play();
}

function easeOut(t, b, c, d) {
  t /= d;
  return -c * t*(t-2) + b;
}

/* --------------- APPLY CUSTOM SEGMENTS --------------- */
function applyCustomSegments() {
  const text = document.getElementById("customSegments").value.trim();
  segments = text.split("\n").filter(x => x.trim() !== "");
  drawWheel();
  alert("Wheel Updated!");
}

/* --------------- TOGGLE CUSTOMIZE SECTION --------------- */
function toggleEditorSection() {
  const section = document.getElementById('editorSection');
  const btn = document.getElementById('toggleEditor');

  if (section.style.display === 'none') {
    section.style.display = 'block';
    btn.innerText = 'Customize Wheel â–¼';
  } else {
    section.style.display = 'none';
    btn.innerText = 'Customize Wheel â–²';
  }
}

drawWheel();
</script>

</body>
</html>
